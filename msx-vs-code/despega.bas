10 REM DESPEGA CON TU MSX
20 CLEAR: D = -172
30 SCREEN 2, 2
40 COLOR 1, 5, 1: CLS
50 GOSUB 6000
60 GOSUB 5000
70 GOSUB 3500
80 GOSUB 2000
90 GOSUB 1000

100 REM INPUT
110 IF STICK(0) = 3 THEN D = D + 1: BEEP: GOTO 140
120 IF STICK(0) = 7 THEN D = D - 1: BEEP: GOTO 140
130 IF STRIG(0) = -1 AND D = -179 THEN GOTO 500
140 GOSUB 150: GOTO 110

150 REM MOVIMIENTO
160 IF D > 7 THEN D = 7: PLAY "S12M5000C"
170 IF D < -179 THEN D = -179: PLAY "S10M500C"
200 PUT SPRITE  4, (216 + D, 168),      1,  1
210 PUT SPRITE  3, (232 + D, 168),     10,  2
220 PUT SPRITE  2, (248 + D, 168),      1,  3
230 PUT SPRITE  1, (232 + D, 168),      1,  4
240 PUT SPRITE 14, (232 + D, 152 + H),  1, 13
250 PUT SPRITE 13, (232 + D, 136 + H),  1, 12
260 PUT SPRITE 12, (232 + D, 120 + H),  1, 11
270 PUT SPRITE 11, (232 + D, 104 + H),  1, 10
280 PUT SPRITE 10, (232 + D,  88 + H),  1,  9
290 PUT SPRITE  9, (248 + D, 152 + H), 15,  8
300 PUT SPRITE 19, (232 + D, 152 + H), 15,  7
310 PUT SPRITE 18, (232 + D, 136 + H), 15,  6
320 PUT SPRITE 17, (232 + D, 120 + H), 15,  6
330 PUT SPRITE 16, (232 + D, 104 + H), 15,  6
340 PUT SPRITE 15, (232 + D,  88 + H), 15,  5
350 PUT SPRITE 26, (216 + D, 136 + H), 14, 19
360 PUT SPRITE 27, (216 + D, 120 + H), 14,  6
370 PUT SPRITE 28, (216 + D, 104 + H),  6,  6
380 PUT SPRITE 29, (216 + D,  88 + H), 14,  6
390 PUT SPRITE 30, (216 + D,  72 + H), 14,  6
400 PUT SPRITE 31, (216 + D,  56 + H),  6, 15
410 IF DS = 5 THEN RETURN
420 PUT SPRITE 20, (216 + D, 152 + H),  1, 18
430 PUT SPRITE 21, (216 + D, 136 + H), 15, 17
440 PUT SPRITE 22, (216 + D, 120 + H),  1, 17
450 PUT SPRITE 23, (216 + D, 104 + H), 15, 17
460 PUT SPRITE 24, (216 + D,  88 + H),  1, 17
470 PUT SPRITE 25, (216 + D,  72 + H), 15, 16
480 RETURN

500 REM DESPEGUE
510 H1 = 1: GOSUB 240: GOSUB 7010: FOR R = 1 TO 1000: NEXT: GOSUB 7020
520 FOR R = 1 TO 200: X = RND(1)*35 + 25: Y = RND(1) * 5: PUT SPRITE 0, (X, 168 + Y), 15, 20: NEXT R: PUT SPRITE 0, (S, 209), 15, 20
530 PUT SPRITE 5, (37, 176 + H),  9, 22
540 PUT SPRITE 6, (37, 168 + H), 11, 21
550 FOR R = 1 TO 40: NEXT
560 PUT SPRITE 5, (37, 209)
570 PUT SPRITE 6, (37, 209)
580 H1 = H1 * 1.05: H = H - H1: GOSUB 240
590 IF H <= -115 THEN 600 ELSE 530

600 REM VOLANDO
610 FOR R = 0 TO 31
620 PUT SPRITE R, (0, 209)
630 NEXT: CLS
640 U$ = "S3E4R3E3R6E5R9F3R9F3R6F4"
650 L$ = "S3;C15;BM-2,+G5L6G4L10G3L6H4L10H5"
660 H = -35: D = -120: GOSUB 240: GOSUB 850

690 REM DESACOPLAMIENTO
700 GOSUB 7010: FOR R = 1 TO 300: NEXT: GOSUB 7020: SOUND 12, 20
710 X = D: Y = H: DS = 5: FOR F = 1 TO 90
720 PUT SPRITE 2, (112, 133), 11, 21
730 PUT SPRITE 1, (112, 141),  9, 22
740 FOR R = 1 TO 40: NEXT R
750 PUT SPRITE 2, (112, 209)
760 PUT SPRITE 1, (112, 209)
770 D = X - F: H = Y + F: GOSUB 420: NEXT F
780 FOR R = 20 TO 25: PUT SPRITE R, (0, 209): NEXT
790 SOUND 13, 9: SOUND 8, 11
800 FOR R = 1 TO 1000: NEXT R
810 GOSUB 7010: SOUND 12, 40: FOR R = 1 TO 400: NEXT: GOSUB 7030
820 FOR F = 1 TO 128: D = X - F: H = Y + F: GOSUB 350: NEXT F
830 PUT SPRITE 7, (128, 117), 1, 14
840 FOR R = 1 TO 1500: NEXT: GOTO 8000

850 REM NUBES MOVILES
860 FOR V = 1 TO 180
870 PUT SPRITE 2, (96, 133), 11, 21
880 PUT SPRITE 1, (96, 141),  9, 22
890 PSET (30, -15+V), 5
900 DRAW U$ + L$
910 PUT SPRITE 2, (96, 209)
920 PUT SPRITE 1, (96, 209)
930 PSET (85, 5 + V), 5
940 DRAW U$ + L$
950 PSET (175, -35 + V), 5
960 DRAW U$ + L$
970 NEXT V
980 COLOR 1, 4: CLS: RETURN

1000 REM GRAFICOS M-1/VENTANA
1010 RESTORE 1120
1020 FOR A = 20 TO 31
1030 A$ = ""
1040 FOR B=1 TO 32
1050 READ C$
1060 X$ = "&H" + C$
1070 C = VAL(X$)
1080 A$ = A$ + CHR$(C)
1090 NEXT B
1100 SPRITE$(A) = A$
1110 NEXT A

1120 REM **LLAMAS COHETE**
1130 DATA 00, 3B, 7B, 7F, 7F, 3F, 7F, FF, FF, FF, FF, 7F, 3F, 1F, 0F, 07, E0, F0, F0, FC, FE, FE, FF, FF, FF, FF, FF, FE, FC, FE, BE, 38
1140 DATA 1F, 3F, 7F, 7F, 7F, FF, FF, FF, FF, FF, 7F, 7F, 7F, 7F, 3F, 1F, F8, FC, FE, FE, FE, FF, FF, FF, FF, FF, FE, FE, FE, FC, FC, F8
1150 DATA 02, 0A, 0B, 1F, 1F, 1F, 2F, 2F, 1F, 1F, 17, 16, 06, 06, 04, 04, 08, 48, 48, 48, 68, FC, FC, FC, F8, F8, F8, B8, A8, A8, A0, A0
1170 DATA 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 01, 03, 07, 02, 01, 00, 00, 00, 00, 00, 00, 00, 00, 00, 40, E0, DE, BE, 7E, FC, F8, 00

1180 REM LLAMAS
1190 DATA 00, 00, 00, 00, 00, 00, 00, 00, 00, 03, 1F, FB, 06, 0F, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 78, FE, 3F, FF, E7, FE, 38, 00
1200 DATA 0F, 3F, 7F, FF, FF, FF, FF, 7F, 7F, 7F, 7F, 7F, 3F, 0F, 00, 00, F8, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, F8, 00, 00
1210 DATA 0C, 3F, 7F, F1, FF, 7F, FF, 78, FF, 7F, 3F, 0C, 00, 00, 00, 00, 00, E0, F8, E0, FF, FC, FF, FE, F0, F8, E0, 00, 00, 00, 00, 00

1220 REM SATELITE
1230 DATA 80, 80, 80, 80, 80, 80, FF, 07, 07, 07, 03, 00, 00, 00, 00, 00, 01, 01, 01, 01, 01, 01, FF, E0, E0, E0, C0, 00, 00, 00, 00, 00
1240 DATA 00, 00, 00, 00, 00, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, 00, 00, 00, 00, 00, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF
1250 DATA 00, 00, 00, 00, 00, 78, 02, 78, 78, 00, 7A, 78, 00, 78, 7A, 00, 00, 00, 00, 00, 00, 1E, 00, 1E, 5E, 00, 1E, 1E, 40, 1E, 1E, 00
1260 DATA 00, 00, 00, 00, 00, 78, 78, 02, 78, 78, 00, 7A, 78, 00, 78, 7A, 00, 00, 00, 00, 00, 5E, 1E, 00, 1E, 5E, 00, 1E, 1E, 40, 1E, 1E
1270 DATA 00, 00, 00, 00, 00, 00, 78, 78, 02, 78, 78, 00, 7A, 78, 00, 78, 00, 00, 00, 00, 00, 00, 5E, 1E, 00, 1E, 5E, 00, 1E, 1E, 40, 1E
1280 RETURN

2000 REM COHETE
2010 RESTORE 2170
2020 FOR A = 5 TO 19
2030 A$ = ""
2040 FOR B=1 TO 32
2050 READ C$
2060 X$ = "&H" + C$
2070 C = VAL(X$)
2080 A$ = A$ + CHR$(C)
2090 NEXT B
2100 SPRITE$(A) = A$
2110 NEXT A

2170 REM **FONDO COHETE**
2180 DATA 78, 7C, FE, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, 00, 00, 00, 00, 80, 80, C0, C0, E0, E0, F0, F8, FC, FE, FF, FF
2190 DATA FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF
2200 DATA FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, E0, 00, 00, 00, 00, 00, FF, FF, FF, FF, FF, FF, FF, FF, FF, BF, 38, 38, 38, 00, 00, 00
2210 DATA 80, E0, F0, F8, FE, FF, FF, FF, FF, FF, 3F, 3F, 0F, 01, 00, 00, 00, 00, 00, 00, 00, 00, 80, C0, F0, F8, FC, FE, FF, FF, 1F, 03

2220 REM **DETALLE COHETE**
2230 DATA 78, 7C, FE, FF, FF, FC, FC, FC, FC, FC, FC, FC, F8, F8, F8, F8, 00, 00, 00, 00, 80, 80, 00, 00, 60, 00, 00, 18, 1C, 3E, 3E, 3C
2240 DATA 80, C0, C0, C0, C0, E0, E0, E0, E0, E0, E0, E0, E0, E0, E0, E0, 3C, 3C, 00, 7F, 40, 50, 50, 50, 50, 40, 40, 40, 40, 7F, 40, 40
2250 DATA E0, E0, E0, E0, E0, E0, E0, E0, E6, E6, E0, E0, E0, E0, E0, E0, 40, 40, 40, 40, 40, 40, 40, 40, 7F, 40, 40, 40, 40, 40, 40, 40
2260 DATA EC, EC, EC, EC, EC, EC, EC, CC, CC, CC, CC, CC, CC, CC, CC, CC, 40, 7F, 40, 40, 40, 40, 40, 40, 40, 40, 40, 7F, 00, 00, 1C, 20
2270 DATA C0, C0, 80, 80, 80, E1, F3, F3, F3, F0, FC, 7E, 7E, 7F, FF, C0, 40, 40, 40, 40, 40, C0, C0, C0, C0, 10, 06, 17, 07, 3F, 3F, 30
2280 DATA 00, 60, 70, 58, 4E, 43, 01, 00, 0C, 0A, 09, 08, 88, 80, C0, 00, 00, 00, 00, 00, 00, 00, 80, C0, 70, 18, 8C, 66, 13, 0D, 05, 01

2290 REM **FONDO IMPULSOR**
2300 DATA 01, 03, 07, 07, 0F, 0F, 1F, 1F, 3F, 3F, 7F, 7F, 7F, FF, FF, FF, 80, C0, E0, E0, F0, F0, F8, F8, FC, FC, FE, FE, FE, FF, FF, FF

2310 REM **DETALLE IMPULSOR**
2320 DATA 01, 01, 01, 03, 03, 03, 07, 07, 07, 0F, 0F, 0F, 0F, 0F, 0F, 0F, 80, 80, 80, C0, C0, C0, E0, E0, E0, F0, F0, F0, F0, F0, F0, F0
2330 DATA 0F, 0F, 0F, 0F, 0F, 0F, 0F, 0F, 0F, 0F, 0F, 0F, 0F, 0F, 0F, 0F, F0, F0, F0, F0, F0, F0, F0, F0, F0, F0, F0, F0, F0, F0, F0, F0
2340 DATA 0F, 0F, 1F, 0F, 0F, 1F, 0F, 0F, 1F, 0F, 0F, 1F, 1F, 3F, 07, 0F, F0, F0, F8, F0, F0, F8, F0, F0, F8, F0, F0, F8, F8, FC, E0, F0
2350 DATA FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, 7F, 7F, 1F, 07, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FF, FE, FE, F8, E0
2360 RETURN

3500 REM PLATAFORMA
3510 RESTORE 3700
3520 FOR A = 1 TO 4
3530 A$ = ""
3540 FOR B=1 TO 32
3550 READ C$
3560 X$ = "&H" + C$
3570 C = VAL(X$)
3580 A$ = A$ + CHR$(C)
3590 NEXT B
3600 SPRITE$(A) = A$
3610 NEXT A

3700 REM DATAS SPRITES
3710 DATA FF, FF, FF, FF, 00, 15, 40, 10, B8, 10, 40, 15, 00, 00, 00, 00
3720 DATA FF, FF, FF, FF, 00, 54, 00, 1D, 1C, 1D, 00, 54, 00, 00, 00, 00
3730 DATA FF, FF, FF, FF, FF, 7F, 7F, 7F, 3F, 00, 00, 00, 00, 00, 00, 00
3740 DATA FF, FF, FF, FF, FF, FE, FE, FE, FC, 00, 00, 00, 00, 00, 00, 00
3750 DATA FF, FF, FF, FF, 00, 2A, 00, B8, 38, B8, 00, 2A, 00, 00, 00, 00
3760 DATA FF, FF, FF, FF, 00, A8, 02, 08, 1D, 08, 02, A8, 00, 00, 00, 00
3770 DATA FF, 00, 00, 00, C0, 40, 40, 60, 3F, 00, 00, 00, 00, 00, 00, 00
3780 DATA FF, 00, 00, 00, 03, 02, 02, 06, FC, 00, 00, 00, 00, 00, 00, 00
3790 RETURN

5000 REM GRAFICOS F-1
5010 A$ = "R5H4L8H3L9H3L9G5L6G3L3G4F5R10F4R8E3R11E4R6E4"
5020 RESTORE 5080: FOR N=1 TO 8
5030 READ X, Y, S
5040 PSET (X,Y), 15
5050 DRAW "S" + STR$(S) + A$
5060 PAINT (X-3, Y), 15
5070 NEXT N
5080 DATA  70,  55, 3, 120, 90, 2, 222, 130, 3, 110, 20, 1, 220, 10, 2
5090 DATA 130, 110, 1, 180, 67, 4,  30,  30, 1

5100 REM TORRE
5110 A$ = "S3D9BM+4,-9D9BM+4,-9D9BM+10,U6E3D9L21BM+,-5R7BM-,-1R11BM+,+3L9BM-1,+2H8"
5120 FOR A = 42 TO 175 STEP 7
5130 PSET (9, A), 1
5140 DRAW A$
5150 NEXT A

5160 REM SOPORTE 1
5170 A$ = "R4E4L4D4"
5180 PSET (9, 41), 1
5190 FOR A = 1 TO 10
5200 DRAW A$
5210 NEXT A
5220 A$ = "D5L6U5R6G5"
5230 PSET (11, 37), 1
5240 DRAW A$

5250 REM SOPORTES 2-3
5260 A$ = "R4D4L4E4"
5270 PSET (24, 90), 1
5280 GOSUB 5390
5290 PSET (24, 130), 1
5300 GOSUB 5390
5310 RETURN

5390 REM SUB SOPORTES
5400 FOR A = 1 TO 4
5410 DRAW A$
5420 NEXT A
5430 RETURN

6000 REM PAISAJE
6010 LINE (  0, 160)-(255, 191),  3, BF
6020 LINE ( 15, 171)-(255, 181),  1, B
6030 LINE ( 16, 172)-(255, 180), 14, BF
6040 LINE (182, 152)-(249, 164), 10, BF
6050 LINE (182, 149)-(249, 151),  6, BF
6060 LINE (184, 152)-(247, 159),  5, BF
6070 FOR V = 184 TO 240 STEP 8
6080 LINE (V, 152)-(V+7, 159), 1, B
6090 NEXT V
6100 CIRCLE (75, 159), 20, 11, -0.001, -3.1416, 0.9
6110 PAINT (80, 157), 11
6120 CIRCLE (75, 159), 12, 6, -0.001, -3.1416, 0.9
6130 PAINT (80, 157), 6
6140 RETURN

7000 REM SONIDO
7010 RESTORE 7110: GOTO 7100
7020 RESTORE 7120: GOTO 7100
7030 RESTORE 7130: GOTO 7100
7040 RESTORE 7140: GOTO 7100
7050 RESTORE 7150: GOTO 7100
7100 FOR R = 0 TO 13: READ S: SOUND R, S: NEXT: R = 0: RETURN
7110 DATA  0, 0, 0,  0,   0, 0, 29, 7, 16, 16, 16,  0,  90,  1
7120 DATA 60, 5, 8, 13, 100, 1, 24, 4, 10, 16, 16,  8, 200, 13
7130 DATA  0, 0, 0,  0,   0, 0,  1, 7,  6,  6,  6,  0,   0,  0
7140 DATA  0, 0, 0,  0,   0, 0, 30, 7, 16,  0,  0, 60,   0, 14
7150 DATA  0, 0, 0,  0,   0, 0, 25, 7,  0,  0, 16,  0,  80,  0

8000 REM 2.PARTE COLUMBIA
8010 CLEAR
8020 DIM X(35), Y(35), C(35)
8030 GOSUB 8500
8040 GOSUB 9000
8050 GOSUB 9200
8060 GOSUB 9500
8070 GOTO 9700

8500 REM GRAFICOS COLUMBIA
8510 A$ = "S4E9R1E1R100U3E1U2E35R8"
8520 B$ = "S4L1D1L2G5D5F4R6F1R140U18R5E1R2E1U7L9U9"
8530 C$ = "L18D1G1D14F2R16"
8540 D$ = "D1F2R5E3U3L5H1G5"
8550 E$ = "R6U4E34R9"
8560 F$ = "D4R16D2R12D9"
8570 G$ = "U1R5U1R16U1R23U1R44D1R7D1R8D1R7"
8580 H$ = "U3R3U1R3U1R3U1R3U1R3"
8590 I$ = "D3F1D2R6U2E1U3L8"
8600 J$ = "D5R6U5L6"
8610 K$ = "R3U2"
8620 L$ = "D16R21U16D16R21U16D16R21U16D16R21U16"
8630 M$ = "R9D1R8L17"
8640 N$ = "R1D3R5U1R6U1R5U1R4D13L4U1L5U1L6U1L5D4L1U13"
8650 O$ = "L14BM+15,-24R7"
8660 P$ = "D2R4U1R3U1R2U1R2U1R2U1R2U1R1U1R3D5R1D5R1D4L1D1L3U1L8"
8670 FOR R = 7 TO 19
8680 PUT SPRITE R, (0, 209)
8690 NEXT R
8700 RETURN

9000 REM FONDO COLUMBIA
9010 PSET (65, 89), 15: DRAW A$
9020 PSET (48, 98), 15: DRAW B$
9030 LINE ( 48, 98)-( 64, 89), 15
9040 LINE (191, 79)-(211, 70), 15
9050 LINE (221, 39)-(211, 70), 15
9060 PAINT (112, 102), 15
9070 PSET (48, 98), 1: DRAW B$
9080 RETURN

9200 REM DETALLES COLUMBIA
9210 PSET (191,  78), 4: DRAW C$
9220 PSET ( 66,  88), 1: DRAW D$: PAINT (75, 88), 1
9230 PSET (172,  78), 4: DRAW E$
9240 PSET ( 48,  98), 1: DRAW F$: PAINT (60, 107), 1
9250 PSET ( 80, 113), 1: DRAW G$: PAINT (120, 113), 1
9260 PSET (176, 111), 1: DRAW H$
9270 PSET (181,  96), 1: DRAW I$: PAINT (182, 99), 1
9280 PSET ( 89, 100), 4: DRAW J$
9290 PSET (104,  99), 4: DRAW K$
9300 PSET (121,  99), 4: DRAW K$
9310 PSET ( 85,  79), 4: DRAW L$
9320 PSET (192, 113), 1: DRAW M$
9330 PSET (192,  97), 1: DRAW N$: PAINT (194, 102), 1
9340 PSET (211,  70), 1: DRAW O$: LINE (196, 70)-(212, 46), 1
9350 PSET (192,  81), 1: DRAW P$: PAINT (196, 84), 1
9360 PUT SPRITE 7, (61, 75), 11, 23

9400 REM MEZCLA DE CARACTERES
9410 COLOR 8, 1, 1: OPEN "GRP:" FOR OUTPUT AS #1
9420 PSET (128, 98), 1
9430 PRINT #1, CHR$(219)
9440 PSET (128, 98): COLOR 4, 15, 1
9450 PRINT #1, CHR$(211) + " " + CHR$(192) + CHR$(192) + CHR$(192)
9460 PSET (88, 86), 1
9470 PRINT #1, CHR$(192) + CHR$(192) + "      " + CHR$(220) + CHR$(220): CLOSE
9480 A$ = "": B$ = "": C$ = "": D$ = "": E$ = ""
9490 RETURN

9500 REM PAISAJE ESTELAR
9510 CIRCLE (127, 190), 194, 7, , , 0.3
9520 LINE (0, 150)-(255, 191), 7, BF
9530 PAINT (120, 145), 7
9540 CIRCLE (127, 190), 164, 5, , , 0.3
9550 LINE (0, 160)-(255, 191), 5, BF
9560 PAINT (120, 158), 5
9570 RETURN

9700 REM MOVIMIENTO LUNA ESTRELLAS
9710 RESTORE 9970: GOSUB 9950
9720 ON INTERVAL = 75 GOSUB 9900: INTERVAL ON
9730 FOR D = 0 TO 160
9740 GOSUB 9850
9750 IF STRIG(0) = -1 THEN GOTO 10000
9760 GOSUB 9850
9770 NEXT D: GOTO 10000

9850 REM PARPADEO ESTRELLAS
9860 FOR R = 1 TO 30: C = INT(RND(1)*5): IF C>=3 THEN C(R) = 15 ELSE C(R) = 4
9870 NEXT
9880 FOR R = 1 TO 30: PSET (X(R), Y(R)), C(R): NEXT: RETURN

9900 REM SUBRUTINA LUNA/BEEP
9910 CIRCLE (X, 25), 10,  4
9920 CIRCLE (X, 25),  9, 15
9930 PAINT (X, 25), 15
9940 X = X + 1: BEEP: RETURN

9950 REM POSICION ESTRELLAS
9960 FOR R = 1 TO 30: READ X(R), Y(R): NEXT R: RETURN
9970 DATA 10, 80,  32, 11,  56, 5,  90, 9,  156, 20,  167, 12,  173, 40,  245, 3,  2, 43,  25, 31,  16, 125,  35, 45,  89, 56,  125, 70,  110, 65,  132, 118,  189, 123,  54, 120,  250, 110,  23, 100,  2, 60,  10, 67,  23, 105,  40, 117,  89, 3,  92, 5
9975 DATA 180, 34,  205, 39,  250, 70,  100, 117: REM PREVIOUS LINE LONGER THAN ALLOWED 255 CHARACTERS IN WEBMSX

10000 REM CAPTURA SATELITE
10010 REM INICIALIZACION
10020 INTERVAL OFF: PAINT (X, 25), 4
10030 ON INTERVAL = 12.5 GOSUB 10450: INTERVAL ON: MV = 28: VN = 1: XS = -10: VC = 80: SC = 0: CS = 0: TP = 500
10040 OPEN "GRP:" FOR OUTPUT AS #1: COLOR 1, 15: PSET (15, 182): PRINT #1, "TIEMPO 500  SATELITES 00"
10050 ON KEY GOSUB 10650: KEY(1) ON

10100 REM APERTURA
10110 A$ = INKEY$: IF A$<>"A" AND A$<>"a" THEN GOTO 10110
10120 GOSUB 7040: FOR Y = 79 TO 95: LINE (86, Y)-(168, Y), 4: FOR D = 1 TO 100: NEXT D: NEXT Y: GOSUB 7050

10150 REM BRAZO
10160 LINE (92, 90)-(126, 94), 14, BF: CIRCLE (127, 92), 2, 14: PAINT (128, 92), 14
10170 PUT SPRITE 0, (86, 82), 8, 27

10200 REM IMPUT BRAZO
10210 IF STICK(0) <> 1 AND STICK(0) <> 5 THEN GOTO 10300
10220 IF STICK(0) = 1 THEN B = B + 2: IF B >= 60 THEN B = 60: GOTO 10300
10230 IF STICK(0) = 5 THEN B = B - 2: IF B <= -2 THEN B =  0: GOTO 10300

10240 REM MOVIMIENTO BRAZO
10250 Y1 = INT(35*SIN(B/57.296)): X1 = INT(35*COS(B/57.296))
10260 LINE (95, 94)-(132, 30), 4, BF
10270 LINE (95     , 93     )-(95 + X1, 93 - Y1  ), 14: LINE (96, 94       )-(96 + X1, 94 - Y1), 14
10280 LINE (96 + X1, 92 - Y1)-(96     , 92 - Y1*2), 14: LINE (95, 93 - Y1*2)-(95 + X1, 93 - Y1), 14
10290 VC = 83 - Y1*2: PUT SPRITE 0, (86, VC), 8, 27
10295 IF SC = 1 THEN PUT SPRITE 6, (86, VC - 9), 1, 28: PUT SPRITE 5, (86, VC - 9), 7, 30: IF B <= 0 THEN LINE (184, 180)-(207, 190), 15, BF: PSET (184, 182): CS = CS + 1: PRINT #1, CS: SC = 0: GOSUB 10600

10300 REM INPUT VELOCIDAD
10310 IF STICK(0) <> 3 AND STICK(0) <> 7 THEN GOTO 10340
10320 IF STICK(0) = 3 THEN VN = VN + 0.1: PUT SPRITE 1, (201, 84), 9, 26: GOSUB 7050: PUT SPRITE 1, (0, 209): CN =   ABS(VN) / 50:  IF CN >  1 THEN CN =  1 ELSE GOTO 10340
10330 IF STICK(0) = 7 THEN VN = VN - 0.1: PUT SPRITE 1, ( 32, 94), 9, 24: GOSUB 7050: PUT SPRITE 1, (0, 209): CN = -(ABS(VN) / 50): IF CN < -1 THEN CN = -1 ELSE GOTO 10340
10340 REM CALCULOS/POS. SATELITE
10350 VN = VN + CN: IF VN > 6 THEN VN = 6
10360 IF VN < -6 THEN VN = -6
10370 IF TP <= 0 THEN TP = 0: INTERVAL OFF: FOR D = 1 TO 6: PUT SPRITE D, (0, 209): NEXT D
10380 GOTO 10200

10450 REM MOVIMIENTO
10460 TP = TP - 0.25: XS = XS + VN: MV = MV + 1: IF MV = 32 THEN MV = 29: LINE (64, 180)-(95, 190), 15, BF: PSET (62, 182): PRINT #1, INT(TP)
10470 IF XS >= 255 THEN XS = 255
10480 IF XS <=  -16 THEN XS = -16
10490 PUT SPRITE 6, (XS, 20), 1, 28: PUT SPRITE 5, (XS, 20), 7, MV: IF INT(XS) > 70 AND INT(XS) < 102 AND VC <= 34 THEN GOSUB 10550
10500 RETURN

10550 REM COLISION
10560 INTERVAL OFF
10570 IF INT(XS) <> 86 THEN GOSUB 7010: FOR D = 6 TO 11: PUT SPRITE 3, (XS, 20), D, 20: NEXT D: PUT SPRITE 5, (0, 209): PUT SPRITE 6, (0, 209): PUT SPRITE 3, (0, 209): GOTO 10600
10580 IF VC <= 31 THEN SC = 1: RETURN
10590 INTERVAL ON: RETURN
10600 XS = 16: VN = 0.5: CN = 0: SC = 0: INTERVAL ON
10610 RETURN

10650 REM CIERRA PUERTA
10660 L$ = "D16R21U16D16R21U16D16R21U16D16R21U16"
10670 IF B = 0 THEN GOTO 10680 ELSE BEEP: RETURN
10680 INTERVAL OFF: FOR D = 0 TO 6: PUT SPRITE D, (0, 209): NEXT D
10690 GOSUB 7040: FOR Y = 95 TO 79 STEP -1: LINE (86, Y)-(168, Y), 15: PSET (85, 79), 4: DRAW L$: FOR D = 1 TO 50: NEXT D: NEXT Y: GOSUB 7050
10700 CLOSE: GOSUB 9400: GOSUB 7030: IF STRIG(0) = -1 THEN GOTO 10750
10710 A$ = INKEY$: IF A$ = "R" OR A$ = "r" THEN CLOSE: LINE (64, 180)-(95, 190), 5, BF: LINE (184, 180)-(207, 190), 5, BF: GOTO 10030
10720 GOTO 10700
10750 REM SALIDA ORBITA



